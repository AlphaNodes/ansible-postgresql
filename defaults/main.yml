# defaults file for postgresql
---

postgresql_version: 9.5
postgresql_postgis_version: 2.2

# php5-pgsql is required for drush sync
postgresql_packages:
 - postgresql-{{ postgresql_version }}-postgis-{{ postgresql_postgis_version }}
 - postgresql-contrib-{{ postgresql_version }}
 - python-psycopg2
 - php5-pgsql
 - pgbadger

postgresql_with_zabbix_monitoring: yes

postgresql_access_hosts: [ ]

# see http://pgtune.leopard.in.ua/ for calculation

# How much memory our PostgreSQL can use for
# buffers. Default value is insanely small.
# If PostgreSQL is the only thing we run on
# the machine, set it to 1/4 of available RAM
postgresql_shared_buffers: 256MB
# How much memory in total our PostgreSQL can use.
# Twice of shared_buffers seems good.
postgresql_effective_cache_size: 1GB
# How many connections we should allow from
# our app, workers, delayed_jobs etc. combined
postgresql_max_connections: 50
postgresql_listen_addresses: localhost
postgresql_port: 5432
postgresql_autovacuum: yes
postgresql_work_mem: 4MB
postgresql_maintenance_work_mem: 64MB
postgresql_synchronous_commit: yes
postgresql_deadlock_timeout: 1s
postgresql_max_wal_size: 2GB
postgresql_min_wal_size: 1GB
postgresql_checkpoint_completion_target: 0.9
postgresql_wal_buffers: 7864kB

postgresql_log_destination: stderr
postgresql_log_statement: none
postgresql_log_line_prefix_syslog: 'user=%u,db=%d,app=%aclient=%h '
postgresql_log_line_prefix_stderr: '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
postgresql_log_min_duration_statement: -1
postgresql_log_checkpoints: no
postgresql_log_connections: no
postgresql_log_disconnections: no
postgresql_log_lock_waits: no
postgresql_log_temp_files: -1
postgresql_log_autovacuum_min_duration: -1

# lc_messages C or en_US is required for pgbadger
postgresql_lc_messages: en_US.UTF-8
postgresql_lc_monetary: '{{ postgresql_lc_messages }}'
postgresql_lc_numeric: '{{ postgresql_lc_messages }}'
postgresql_lc_time: '{{ postgresql_lc_messages }}'

postgresql_default_text_search_config: pg_catalog.english

# Users.
postgresql_users: []

# Databases.
postgresql_databases: []
